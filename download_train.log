root@0bd3504252ed:/workspaces/photo_tag_pipeline# /usr/local/bin/python /workspaces/photo_tag_pipeline/scripts/run_download_data.py
Preparing dataset with max_samples=150, classes=['person', 'dog'], seed=42
[INFO] Downloading splits ('train', 'validation', 'test') from coco-2017 (max 150 samples each)…
Downloading split 'train' to '/root/fiftyone/coco-2017/train' if necessary
[INFO] Downloading split 'train' to '/root/fiftyone/coco-2017/train' if necessary
Found annotations at '/root/fiftyone/coco-2017/raw/instances_train2017.json'
[INFO] Found annotations at '/root/fiftyone/coco-2017/raw/instances_train2017.json'
20 images found; downloading the remaining 130
[INFO] 20 images found; downloading the remaining 130
 100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [15.5s elapsed, 0s remaining, 9.6 images/s]      
[INFO]  100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [15.5s elapsed, 0s remaining, 9.6 images/s]      
Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/train/labels.json'
[INFO] Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/train/labels.json'
Downloading split 'validation' to '/root/fiftyone/coco-2017/validation' if necessary
[INFO] Downloading split 'validation' to '/root/fiftyone/coco-2017/validation' if necessary
Found annotations at '/root/fiftyone/coco-2017/raw/instances_val2017.json'
[INFO] Found annotations at '/root/fiftyone/coco-2017/raw/instances_val2017.json'
20 images found; downloading the remaining 130
[INFO] 20 images found; downloading the remaining 130
 100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [15.5s elapsed, 0s remaining, 9.0 images/s]      
[INFO]  100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [15.5s elapsed, 0s remaining, 9.0 images/s]      
Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/validation/labels.json'
[INFO] Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/validation/labels.json'
Downloading split 'test' to '/root/fiftyone/coco-2017/test' if necessary
[INFO] Downloading split 'test' to '/root/fiftyone/coco-2017/test' if necessary
Test split is unlabeled; ignoring classes requirement
[WARNING] Test split is unlabeled; ignoring classes requirement
Found test info at '/root/fiftyone/coco-2017/raw/image_info_test2017.json'
[INFO] Found test info at '/root/fiftyone/coco-2017/raw/image_info_test2017.json'
20 images found; downloading the remaining 130
[INFO] 20 images found; downloading the remaining 130
 100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [16.4s elapsed, 0s remaining, 5.2 images/s]      
[INFO]  100% |█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 130/130 [16.4s elapsed, 0s remaining, 5.2 images/s]      
Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/test/labels.json'
[INFO] Writing annotations for 150 downloaded samples to '/root/fiftyone/coco-2017/test/labels.json'
Dataset info written to '/root/fiftyone/coco-2017/info.json'
[INFO] Dataset info written to '/root/fiftyone/coco-2017/info.json'
You are running the oldest supported major version of MongoDB. Please refer to https://deprecation.voxel51.com for deprecation notices. You can suppress this exception by setting your `database_validation` config parameter to `False`. See https://docs.voxel51.com/user_guide/config.html#configuring-a-mongodb-connection for more information
[WARNING] You are running the oldest supported major version of MongoDB. Please refer to https://deprecation.voxel51.com for deprecation notices. You can suppress this exception by setting your `database_validation` config parameter to `False`. See https://docs.voxel51.com/user_guide/config.html#configuring-a-mongodb-connection for more information
Loading 'coco-2017' split 'train'
[INFO] Loading 'coco-2017' split 'train'
 100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [834.5ms elapsed, 0s remaining, 179.7 samples/s]      
[INFO]  100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [834.5ms elapsed, 0s remaining, 179.7 samples/s]      
Loading 'coco-2017' split 'validation'
[INFO] Loading 'coco-2017' split 'validation'
 100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [857.0ms elapsed, 0s remaining, 175.0 samples/s]      
[INFO]  100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [857.0ms elapsed, 0s remaining, 175.0 samples/s]      
Loading 'coco-2017' split 'test'
[INFO] Loading 'coco-2017' split 'test'
Dataset is unlabeled; ignoring classes requirement
[WARNING] Dataset is unlabeled; ignoring classes requirement
 100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [59.4ms elapsed, 0s remaining, 2.5K samples/s]      
[INFO]  100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [59.4ms elapsed, 0s remaining, 2.5K samples/s]      
Dataset 'coco-2017-train-validation-test-150' created
[INFO] Dataset 'coco-2017-train-validation-test-150' created
[INFO] Loaded 450 samples in total
[INFO] Filtering dataset to 2 target classes
[INFO] View retains 300 samples after label filtering
[INFO] Creating train/val/test tags (seed=42)…
[INFO] Exporting train split → /workspaces/photo_tag_pipeline/src/data/coco/train (COCO) …
 100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 362/362 [14.9s elapsed, 0s remaining, 27.3 samples/s]      
[INFO]  100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 362/362 [14.9s elapsed, 0s remaining, 27.3 samples/s]      
[INFO] Exporting val split → /workspaces/photo_tag_pipeline/src/data/coco/val (COCO) …
 100% |██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [2.0s elapsed, 0s remaining, 22.2 samples/s]      
[INFO]  100% |██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [2.0s elapsed, 0s remaining, 22.2 samples/s]      
[INFO] Exporting test split → /workspaces/photo_tag_pipeline/src/data/coco/test (COCO) …
 100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [7.4s elapsed, 0s remaining, 35.2 samples/s]      
[INFO]  100% |████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [7.4s elapsed, 0s remaining, 35.2 samples/s]      
[INFO] Metadata saved → /workspaces/photo_tag_pipeline/src/data/coco/dataset_metadata.json
Dataset preparation finished.
root@0bd3504252ed:/workspaces/photo_tag_pipeline# /usr/local/bin/python /workspaces/photo_tag_pipeline/scripts/run_train.py
[WARNING] Experiment ID mismatch for exp minimalBaseLine727523185351364200. ID recorded as '727523185351364200' in meta data. Experiment will be ignored.
NoneType: None
2025/06/11 17:38:41 INFO mlflow.tracking.fluent: Experiment with name 'photo-tagger' does not exist. Creating a new experiment.
[WARNING] Experiment ID mismatch for exp minimalBaseLine727523185351364200. ID recorded as '727523185351364200' in meta data. Experiment will be ignored.
NoneType: None
Building model, optimizer and scheduler...
Logging parameters to MLflow...
Starting training loop...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:59<00:00,  4.96s/it]
[1/30] train=0.7115  val=0.9279  macroF1=0.666███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:59<00:00,  4.55s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:47<00:00,  3.99s/it]
[2/30] train=0.5269  val=0.9406  macroF1=0.693███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:47<00:00,  3.17s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:52<00:00,  4.38s/it]
[3/30] train=0.4233  val=0.9172  macroF1=0.714███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:52<00:00,  4.50s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:47<00:00,  3.92s/it]
[4/30] train=0.3298  val=0.7131  macroF1=0.708███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:47<00:00,  3.16s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:39<00:00,  3.26s/it]
[5/30] train=0.2527  val=0.7862  macroF1=0.668███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:39<00:00,  3.16s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:39<00:00,  3.32s/it]
[6/30] train=0.1903  val=0.9726  macroF1=0.701███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:39<00:00,  2.83s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:37<00:00,  3.12s/it]
[7/30] train=0.1238  val=0.8204  macroF1=0.694███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:37<00:00,  2.72s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:38<00:00,  3.18s/it]
[8/30] train=0.1345  val=0.9146  macroF1=0.700███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:38<00:00,  3.57s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:33<00:00,  2.77s/it]
[9/30] train=0.1034  val=0.8982  macroF1=0.732███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:33<00:00,  2.22s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:33<00:00,  2.80s/it]
[10/30] train=0.0893  val=1.1821  macroF1=0.680██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:33<00:00,  2.40s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:31<00:00,  2.58s/it]
[11/30] train=0.0776  val=0.9647  macroF1=0.686██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:30<00:00,  2.70s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:31<00:00,  2.66s/it]
[12/30] train=0.0573  val=0.9344  macroF1=0.709██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:31<00:00,  2.29s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:35<00:00,  2.97s/it]
[13/30] train=0.0415  val=0.9812  macroF1=0.683██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:35<00:00,  2.92s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:31<00:00,  2.66s/it]
[14/30] train=0.0405  val=1.0082  macroF1=0.692██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:31<00:00,  2.33s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:41<00:00,  3.42s/it]
[15/30] train=0.0389  val=0.9656  macroF1=0.711██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:40<00:00,  2.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:34<00:00,  2.88s/it]
[16/30] train=0.0302  val=0.9621  macroF1=0.711██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:34<00:00,  2.87s/it]
Early stopping – no improvement.
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 15/30 [12:33<12:33, 50.21s/it]
Training completed and logged to MLflow.